<!DOCTYPE HTML>
<html>
  <head>
    <title>Fishtron</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="js/jquery.js"></script>
    <script>

      var yay = function(){

        var input = $('#yayi').attr('value') ;

        $.ajax({
          //url: 'yay/' + input ,
          url : 'run/' + encodeURIComponent(input) , 
          type: 'GET'  ,
          success: function(wid) {  
              console.log('worker id : ' + wid );

              setTimeout( function(){out( wid , 1 )} , 100 );
          }
        });

      };

      var out = function( wid , oid ){

        if( ! wid ){
          wid = $('#outi').attr('value') ;
          oid = 1;
        }
        
        $.ajax({
          url: 'out/' + wid + '/' + oid ,
          type: 'GET'  ,
          success: function( output ) { 

            if( output === '' ){
              console.log( wid + ' [HOTOVO]' ); 
            } else if( output === '_' ){
              //working ale zatim žadnej output
              //console.log( wid + ': working ...' );
              setTimeout( function(){out( wid , oid )} , 100 );
            } else {
              console.log(wid +': ' + output );
              setTimeout( function(){out( wid , oid+1 )} , 1 );
            }

          }
        });

      }

    </script>
  </head>
	<body>
    <p>Vítá Vás Fishtron! ěščřžýáíé</p>
    <img src="files/logo.png">
    <p>
      run/<input type="text" value="cmd-here" id="yayi"> 
      <input type="button" value="Run!" onclick="yay()">
    </p>
    <p>
      <input type="text" value="3" id="outi"> 
      <input type="button" value="out!" onclick="out()">
    </p>
  </body>
</html>
